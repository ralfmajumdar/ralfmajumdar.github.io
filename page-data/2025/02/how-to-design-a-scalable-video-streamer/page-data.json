{"componentChunkName":"component---node-modules-gatsby-theme-portfolio-minimal-src-templates-article-index-tsx","path":"/2025/02/how-to-design-a-scalable-video-streamer/","result":{"pageContext":{"article":{"banner":{"alt":"","caption":"","src":null},"body":"<!-- ## Code block test -->\n<!-- \n```css\n.AClass .Subtitle {\n  margin: -0.5rem 0 0 0;\n  font-weight: 700;\n  font-size: 1.25rem;\n  line-height: 1.5rem;\n}\n\n.AnotherClass p {\n  font-size: 1.125rem;\n  margin-bottom: 2rem;\n}\n\n.AThirdClass {\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n}\n\n@media (max-width: 768px) {\n  .AClass {\n    flex-direction: column;\n  }\n  .AnotherClass {\n    display: block;\n  }\n}\n``` -->\n<style>\n.styled-table {\n  border-collapse: collapse;\n  margin: 25px 0;\n  font-size: 16px;\n  font-family: sans-serif;\n  min-width: 400px;\n  width: 100%;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n}\n\n.styled-table thead tr {\n  background-color: #009879;\n  color: #ffffff;\n  text-align: left;\n}\n\n.styled-table th,\n.styled-table td {\n  padding: 12px 15px;\n  border: 1px solid #dddddd;\n}\n\n.styled-table tbody tr {\n  border-bottom: 1px solid #dddddd;\n}\n\n.styled-table tbody tr:nth-of-type(even) {\n  background-color: #f3f3f3;\n}\n\n.styled-table tbody tr:hover {\n  background-color: #f1f1f1;\n  cursor: pointer;\n}\n\n.gatsby-resp-image-wrapper {\n  display: inline !important;\n}\n\n</style>\n<p>Want to design the system architecture of a video streaming platform like YouTube? Ever wondered what various components are needed and what it takes to create such a application at scale?</p>\n<h3>Specifications</h3>\n<p>To design such an application we will consider the below:</p>\n<ul>\n<li>Functional Requirements</li>\n<li>Non-functional Requirements</li>\n<li>Capacity planning (Back-of-envelope calculations)</li>\n<li>High-level design</li>\n<li>Deep dive</li>\n</ul>\n<h4>Functional Requirements</h4>\n<p>Below are the functional requirements that the system must address:</p>\n<ol>\n<li>Creator requirements: The creators/uploaders should be able to upload any video. The video needs to be made available for all locations. Latency for upload, processing and publishing is acceptable. Once published, the video should have high availability.</li>\n<li>Viewer requirements: Viewer should be able to view videos (high availability). Video should be compatible across multiple device types. Must be available for all network speeds. User should be able to search videos. User should have home feed (recommendation engine).</li>\n</ol>\n<h4>Non-functional Requirements</h4>\n<p>Let's make the following assumptions:</p>\n<ol>\n<li>We will assume we have 100M Daily Active Users (DAU's) using this application.</li>\n<li>Read:Write ratio is 100:1. Each user watches 100 videos per day while each creator uploads 1 video per day.</li>\n<li>Each video is 500MB in size.</li>\n<li>We would retain the data for 10 years.</li>\n<li>Video loading should have low latency.</li>\n<li>We should be able to scale globally and handle for more user spikes.</li>\n<li>System should have high availibility - should never be down for both users and creators.</li>\n</ol>\n<h4>Capacity Planning (Back-of-envelope calculations)</h4>\n<p>Let's calculate the QPS and storage for this system:</p>\n<h5>QPS (Queries per seconds)</h5>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">QPS = Total number of query requests per day / (Number of seconds in a day)</code></pre></div>\n<p>Assuming 100 million Daily Active Users (DAU), with each user performing one write operation per day and a Read-to-Write ratio of 100:1, the total daily read requests would be 100 million × 100 = 10 billion. This results in a Read QPS (Queries Per Second) of approximately 10 billion ÷ (24 × 3600) ≈ 115,740.</p>\n<h5>Storage</h5>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Storage = Total data volume per day * Number of days retained</code></pre></div>\n<p>Assuming each video is 500MB and there are 100 million write requests per day, the daily data volume amounts to 100 million × 500MB. To retain data for 10 years, the total storage needed is: 100 million × 500MB × 365 days × 10 years ≈ 183EB.</p>\n<h5>Bottlenecks</h5>\n<p>To identify bottlenecks, it is essential to analyze peak traffic periods and user distribution patterns. The primary bottleneck is likely to occur in video delivery, which can be addressed through the use of Content Delivery Networks (CDNs) and effective load balancing across the infrastructure.</p>\n<p>When estimating CDN costs, the primary consideration is content delivery. With a read-to-write ratio of 100:1, the majority of CDN expenses will stem from video streaming. However, implementing aggressive caching strategies and leveraging geographic distribution can significantly optimize these costs.</p>\n<h4>High Level Design</h4>\n<p>For this we will take a modular approach adopting microservices architecture of smaller interconnected services. This allows us for independent scaling, deployment and better fault isolation.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 61.21212121212122%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+0lEQVR42j1TW5aqMBBk/+uZO6PoGRQEFEEQkHcAcSF1u1qZjz6B0KmuR7Dm+QnWNM8YxwlVVaNuGkzTjK7rkOc57vf7p3J9Lx8PjGbE/HziKbUsi9QLy+sFaybQNOlHI02PqkJRlnjIobJ84HKJ4AchXO8E3w8Qns9Ikhv6ftAzCiqATwVdYBHEdb03gJRt7/DrHDAMRhiPOozPaZqiFcZVXaNtW1XAUoXKdNGyBmNwjWNtosStbePoun9AVBAnCb6/fxAEAfb7Pc7CkhZN0sNabWNZ3CBdNvTDgCy743ZLRVL/tkL27+LbZrvV9Xg84hJF6jXVrUx1gJTFIMjSiLy1yJSH86LA9Rqr3LpuBKRStm3boRFF9Jr9f6CTAr43+IESOblpWn1mqkEYIs0yZUwFBKHXDI/JcyhVrn5LKEYCqRRQJUsTi4zyvJCEA5xOJ3iS8sn3dWXKZMihZNzJsOlzWyx+cCRVJshg6NVutxfAWqXlZSG+ZojjRIFYZEyG7GegUXRVAlRh8eF8vqAoSjmYwxYw1/OErRE5pZYRnzmQTLqu10FcKfeWZqqIntMqy4zm48GkTak0JCKDQXx9/VPG9IzMQvGTzNQ/AYiFHe34dRwlxaEWfevk1nPl7V+n8wLzTv5sNjp5TZx31BMFVOEcDmoP/x56yV/2PxT6RJkb8OUfAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/static/9a5848ea74097f8437efc781f5cb91b5/c9b55/video_sd.webp 165w,\n/static/9a5848ea74097f8437efc781f5cb91b5/f2908/video_sd.webp 330w,\n/static/9a5848ea74097f8437efc781f5cb91b5/cc661/video_sd.webp 660w,\n/static/9a5848ea74097f8437efc781f5cb91b5/a66df/video_sd.webp 990w,\n/static/9a5848ea74097f8437efc781f5cb91b5/d33d4/video_sd.webp 1320w,\n/static/9a5848ea74097f8437efc781f5cb91b5/0abaa/video_sd.webp 1536w\" sizes=\"(max-width: 660px) 100vw, 660px\" type=\"image/webp\">\n          <source srcset=\"/static/9a5848ea74097f8437efc781f5cb91b5/04c57/video_sd.png 165w,\n/static/9a5848ea74097f8437efc781f5cb91b5/d9ecf/video_sd.png 330w,\n/static/9a5848ea74097f8437efc781f5cb91b5/1f083/video_sd.png 660w,\n/static/9a5848ea74097f8437efc781f5cb91b5/7a3d6/video_sd.png 990w,\n/static/9a5848ea74097f8437efc781f5cb91b5/78958/video_sd.png 1320w,\n/static/9a5848ea74097f8437efc781f5cb91b5/71c1d/video_sd.png 1536w\" sizes=\"(max-width: 660px) 100vw, 660px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/static/9a5848ea74097f8437efc781f5cb91b5/1f083/video_sd.png\" alt=\"high level design for youtube\" title=\"\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n    </span>\n<p><b>When the user views the videos:</b>\nWhen a user requests to watch a video, the request flows through the <b>Load Balancer and API Gateway</b> to the <b>Video Playback Service</b>. This service first checks caching layers optimized for fast retrieval before querying the <b>Video Metadata Store</b> to obtain the video URL. Once the URL is fetched, the video is streamed directly from the nearest <b>CDN (Content Delivery Network)</b> node to the user's device, ensuring minimal latency and smooth playback.</p>\n<ul>\n<li>The <b>CDN</b> plays a critical role by delivering cached video content from geographically distributed nodes close to the user, significantly improving load times and overall viewing quality.</li>\n<li>The <b>Metadata Database</b> manages essential details such as video titles, descriptions, and user interactions (likes, comments, etc.). These databases are designed to handle large volumes of read operations efficiently.</li>\n</ul>\n<p><b>When the user uploads a video:</b>\nVideo uploads follow a separate flow. The process starts with the <b>Load Balancer and API Gateway</b> routing the upload request to the <b>Video Upload Service</b>.</p>\n<ul>\n<li>\n<p><b>Signed URL Generation</b>: The Video Upload Service requests a signed URL from the <b>Object Storage Service</b>, enabling secure, time-bound access to object storage platforms like <u><b>Amazon S3, Google Cloud Storage, or Azure Blob Storage</u></b>. The signed URL allows the client to upload files without burdening the application servers.</p>\n</li>\n<li>\n<p><b>Direct Upload</b>: The client application layer uses the signed URL to upload the video file directly to the object storage, bypassing the main application servers. This approach enhances scalability by reducing server load.</p>\n</li>\n<li>\n<p><b>Upload Confirmation &#x26; Metadata Submission</b>: Once the upload completes, the client notifies the <b>Video Upload Service</b> and provides relevant metadata, triggering the next set of operations.</p>\n</li>\n<li>\n<p><b>Video Processing Pipeline</b>: Uploaded videos undergo processing, including content moderation, transcoding (to support multiple formats and resolutions), compression, and thumbnail generation.</p>\n</li>\n<li>\n<p><b>CDN Distribution</b>: Finally, the processed video files are uploaded to CDN nodes, making them readily available to end users from the most optimal locations, ensuring fast and reliable playback.</p>\n</li>\n</ul>\n<h4>Deep dive - Low Level Design</h4>\n<p>Low-Level Design (LLD) delves into the detailed technical implementation of the system. It outlines how different components interact, specifies the data structures, class architectures, and defines the design of APIs.</p>\n<ol>\n<li><b>Service Modules</b></li>\n</ol>\n<ul>\n<li><b>Video Upload Service</b>: The Video Upload Service collaborates with the <b>Video Storage Service</b> and the <b>Transcoding Service</b>. Once a video is uploaded, it is stored as raw content in an object storage system (e.g., AWS S3). The Transcoding Service then processes the raw video into various formats and resolutions to ensure compatibility across devices. The upload service exposes endpoints such as <u>POST /upload-video</u> to handle incoming video files along with their metadata.</li>\n<li><b>Video Streaming Service</b>: Once the transcoding process is complete, the Video Streaming Service handles delivering the video to end users. It retrieves the video content from the distributed storage system and streams it in formats and resolutions optimized for the user's device and network conditions. Provides an endpoint such as <u>GET /video/{video_id}/stream</u>, which delivers video chunks for seamless streaming playback.</li>\n</ul>\n<ol start=\"2\">\n<li><b>Class Structure and Object-Oriented Design</b></li>\n</ol>\n<ul>\n<li><b>User Class</b>: Represents a user within the system, containing attributes such as user_id, username, email, password_hash, subscriptions, watch_history, and preferences. Key methods include:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">upload_video()\nlike_video()\nsubscribe_to_channel()\ncreate_playlist()</code></pre></div>\n<ul>\n<li><b>Video Class</b>: Represents a video entity with attributes like video_id, user_id (indicating the uploader), title, description, tags, views_count, upload_timestamp, and additional metadata. Key methods include:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">get_video_info()\nincrease_views()\nadd_comment()\ntranscode_video()</code></pre></div>\n<ol start=\"3\">\n<li><b>Database Schema</b></li>\n</ol>\n<ul>\n<li>We can use <u>relational database for videos and users</u>. We can use <u>non-relational database (like NoSql) for video recommendations, comments</u> etc.</li>\n</ul>\n<ol start=\"4\">\n<li><b>Scalability and Fault Tolerance</b></li>\n</ol>\n<ul>\n<li><b>Service Decomposition</b>: Adopting a microservices architecture enables independent scaling of core components such as video uploads, search, and streaming, ensuring efficient resource utilization based on demand.</li>\n<li><b>Distributed Caching</b>: Implementing caching layers (e.g., Redis) helps store frequently accessed data — such as video metadata, trending content, and user preferences — to deliver faster response times and reduce database load.</li>\n<li><b>Database Sharding</b>: To manage large datasets effectively, databases are partitioned into smaller, distributed shards across multiple servers, improving scalability and the system's ability to handle high data volumes.</li>\n</ul>\n<ol start=\"5\">\n<li><b>Security and Authentication</b></li>\n</ol>\n<ul>\n<li><b>Authentication</b>: Leverage secure protocols like OAuth 2.0 or JSON Web Tokens (JWT) to authenticate users and protect access to the system.</li>\n<li><b>Authorization</b>: Implement Role-Based Access Control (RBAC) to manage user permissions and ensure that only authorized users can perform specific actions.</li>\n<li><b>Data Encryption</b>: Apply end-to-end encryption to safeguard video content and sensitive user data during storage and transmission.</li>\n</ul>\n<p>These represent just a few of the key design elements that must be taken into account when building the architecture of a video streaming platform.</p>\n<hr>\nAuthor: <br/>\n<u><a href=\"https://www.linkedin.com/in/rahul-majumdar/\">Rahul Majumdar</a></u>","categories":["System Architecture","Software Engineering"],"date":"February 07, 2025","description":"Explore the architecture behind scalable video streaming platforms like YouTube. This guide breaks down key components—from CDN optimization and microservices to fault tolerance and storage planning—offering a practical blueprint for building systems that serve millions daily.","id":"8c3a08a7-3587-5049-b131-51106d078eb2","keywords":["Scalable video streaming architecture","Video streaming system design","YouTube-like platform architecture","Microservices for video streaming","CDN optimization for video delivery"],"slug":"/2025/02/how-to-design-a-scalable-video-streamer/","title":"How to Architect a Scalable Video Streaming Platform","readingTime":{"text":"8 min read"}},"listingPagePath":"/blog"}},"staticQueryHashes":["3262260831","948380417"],"slicesMap":{}}